********************************************************************************
$ontext

   Dairdyn project

   GAMS file : GEN_res2GLOBIOM.GMS

   @purpose  : summary results for the connection to GLOBIOM
   @author   : D.Sch√§fer
   @date     : 04.07.2022
   @since    :
   @refDoc   :
   @seeAlso  :
   @calledBy :

$offtext
********************************************************************************

set feedBasket      "All potential feeds"
                    /
                      set.feeds ";    Crops in ton FM other inputs in either ton or litre FM"
                    /;

set cropPatternCrops     "All Potential crops in ha"
                   /
                     set.crops "crops in hectare"
                   /;

set otherItems     "Relevant items to calculate the required GLOBIOM data" /
                  profit "profit in Euro (2020)"
                  GWP    "GWP in CO2eq-kg"
                  entFermGWP "CO2-eq (kg) emissions from enteric fermentation"
                  staStoGWP  "CO2-eq (kg) emissions from stable and storage losses"
                  manApplGWP "CO2-eq (kg) emissions from manure application"
                  minApplGWP "CO2-eq (kg) emissions from mineral fertilizer application"
                  pastGWP    "CO2-eq (kg) emissions from pasture droppings"
                  inputGWP   "CO2-eq (kg) emissions from purchased upstream inputs"
                  fieldGWP   "CO2-eq (kg) emissions from field emissions (e.g. liming)"
                  cowLU      "Number of cows in livestock units"
                  heifersLU  "Number of heifers in livestock units"
                  milkOutput  "total milk production in kg"
                  productivChange "Change in productivity in total"
                    /;

* [TODO - The indicated measure should be represented what is currently called "vegOil" -
*          Include set which will return the given measure set based on the globals set from the GUI]
* --- (1) Difference in profit is required for abatement costs - Collect the profit
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"profit")) = sum(nCur, v_objeN.l(nCur)*p_probn(nCur));
* --- (2) Number of cows, heifers and the milkoutput
$iftheni.c "%cattle%" == true
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"cowLU"))         = p_res(%1,%2,"cows","levl"," ","mean");
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"heifersLU"))     = sum((breeds,tCur),p_res(%1,%2,"sumHerdheifs","Quant",Breeds,tCur)* p_luSumHerds("heifs",Breeds))/p_cardTcur;
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"milkOutput"))    = p_res(%1,%2,"milkYear","Quant","","mean");
$endif.c
* --- (3) GWP per farm (kg CO2eq)
$iftheni.emission "%envAcc%" == true
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"GWP"))           = p_res(%1,%2,"totGWP","Quant","","mean");
* --- (4) GWP per farm in category (kg CO2eq)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"entFermGWP"))    = p_res(%1,%2,"entFermGWP","Quant","","mean");
* --- (5) GWP per farm in category (kg CO2eq)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"stastoGWP"))     = p_res(%1,%2,"staStoGWP","Quant","","mean");
* --- (6) GWP per farm in category (kg CO2eq)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"manApplGWP"))    =   p_res(%1,%2,"manApplGWP","Quant","","mean");
* --- (7) GWP per farm in category (kg CO2eq)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"minApplGWP"))    =   p_res(%1,%2,"minApplGWP","Quant","","mean");
* --- (7) GWP per farm in category (kg CO2eq)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"pastGWP"))    =   p_res(%1,%2,"pastGWP","Quant","","mean");
* --- (8) GWP per farm in category (kg CO2eq)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"inputGWP"))           =   p_res(%1,%2,"inputGWP","Quant","","mean");
* --- (9) GWP per farm in category (kg CO2eq)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","otherItems",otherItems) $(sameas(otherItems,"fieldGWP"))           =   p_res(%1,%2,"fieldGWP","Quant","","mean");
$endif.emission

$iftheni.cattle "%cattle%"== true
* --- (10) Feed use (t) per farm
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","feedBasket",curFeeds)$(sum(sameas(feedBasket,curFeeds),1)) = sum((t_n(tCur,nCur)), p_probn(nCur) * v_feeduse.l(curFeeds,tCur,nCur));
$endif.cattle
* --- (11) Cropping pattern (ha)
p_sumRes2GLOBIOM(%1,%2,"BOVD","vegOil","cropPatternCrops",curCrops) $((not sameas(curcrops,"CCmustard"))
                                                           $(sum(sameas(cropPatternCrops,curCrops),1)))
                                                           =   p_res(%1,%2,curCrops,"levl","","mean");





 * --- Profits/Premiums

    p_sumResSwizz(%1,"profit","") = round (p_res("Base",%1,"objval","sum","","mean") ,2);
    p_sumResSwizz(%1,"totalPolicyPayments","")   =   round ( sum (t_n(tCur,nCur), v_aesPrem.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premFoodSupply","")        =   round ( sum (t_n(tCur,nCur), v_premFoodSupply.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premArab","")              =   round ( sum (t_n(tCur,nCur), v_premArab.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premGMF","")               =   round ( sum (t_n(tCur,nCur), v_premGMF.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premBFF","")               =   round ( sum (t_n(tCur,nCur), v_premBFF.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premAnm","")               =   round ( sum (t_n(tCur,nCur), v_premAnimal.l (tCur,nCur) ) /p_cardtCur   ,2  );



* --- Current crops in ha

    p_sumResSwizz(%1,curCrops,"") = round (p_res("Base",%1,curCrops,"levl","","mean"),2);

* --- Animals in livestock units

    p_sumResSwizz(%1,"cowsLu","") = round (p_res("Base",%1,"cows","levl"," ","mean"),2)  ;
    p_sumResSwizz(%1,"motherCowsLu","") = round (p_res("Base",%1,"motherCow","levl"," ","mean"),2);
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"heifs")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean")     *0.6),2) ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"bulls")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean")     *0.4),2) ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"mCalvsRais")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean") * 0.3),2)  ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"mCalvsSold")    = round (p_res("Base",%1,possHerds,"levl"," ","mean"),2)  ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"fCalvsRais")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean") * 0.3),2) ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"fCalvsSold")    = round (p_res("Base",%1,possHerds,"levl"," ","mean"),2);

* --- Labour hours

    p_sumResSwizz(%1,"totalLabourHrs","")   =    p_res("Base",%1,"onFarm","hours","","mean");
    p_sumResSwizz(%1,"hiredLabourHrs","")  =   p_res("Base",%1,"hiredLabour","hours","","mean")  ;


*NH3,GWP,CO2,CH4,N2O,N2oind,N2
*GWP,CO2,CH4,N2O


* ---- Important GWP Units
    p_sumResSwizz(%1,"totalGWP","")    = p_res("Base",%1,"totGWP","Quant","","mean");
    p_sumResSwizz(%1,"entFermGWP","")    = p_res("Base",%1,"entFermGWP","Quant","","mean");
    p_sumResSwizz(%1,"inputGWP","")    = p_res("Base",%1,"inputGWP","Quant","","mean");
* --- emission separated by CO2,CH4,N2o and GWP for emiCrops and emiHerds

   p_sumResSwizz(%1,"emisCrops","CO2")  = p_res("Base",%1,"emiCropsCO2","Quant","","mean");
   p_sumResSwizz(%1,"emisCrops","CH4")  = p_res("Base",%1,"emiCropsCH4","Quant","","mean");
   p_sumResSwizz(%1,"emisCrops","N2O")  = p_res("Base",%1,"emiCropsN2O","Quant","","mean");

   p_sumResSwizz(%1,"emisHerds","CO2")  = p_res("Base",%1,"emiherdsCO2","Quant","","mean");
   p_sumResSwizz(%1,"emisHerds","CH4")  = p_res("Base",%1,"emiherdsCH4","Quant","","mean");
   p_sumResSwizz(%1,"emisHerds","N2O")  = p_res("Base",%1,"emiherdsN2O","Quant","","mean");

   p_sumResSwizz(%1,"emisOther","CO2")  = p_res("Base",%1,"emiotherCO2","Quant","","mean");
   p_sumResSwizz(%1,"emisOther","CH4")  = p_res("Base",%1,"emiOtherCH4","Quant","","mean");
   p_sumResSwizz(%1,"emisOther","N2O")  = p_res("Base",%1,"emiOtherN2O","Quant","","mean");

