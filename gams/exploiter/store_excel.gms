********************************************************************************
$ontext

   FARMDYN project

   GAMS file : STORE_EXCEL.GMS

   @purpose  :
   @author   :
   @date     : 12.11.10
   @since    :
   @refDoc   :
   @seeAlso  :
   @calledBy :

$offtext
********************************************************************************


$batinclude 'util/title.gms' "'Store result in EXCEL sheet for '" ' %3 ' ' %4 '


$setglobal excelFileName  %1
$setglobal gdxFileName %2

  put_utility 'shell' / "cp /Y ../results/expFarms/template.xls %excelFileName%";
*
*  --- store herds (detailed)
*
  option kill=p_excelOut2;
  p_excelOut2(herds,t) = p_res(%3,%4,herds,"herd",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=HerdSizeDetailed!';

*
*  --- store herds (summary)
*
  option kill=p_excelOut2;
  p_excelOut2(summaryHerds,t) = p_res(%3,%4,SummaryHerds,"herd",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=HerdSizeSummary!';
*
*  --- store main parameters of dairy cows
*
  option kill=p_excelOut2;
  p_excelOut2("herd",t) = p_res(%3,%4,"cows","herd",t) + eps;
  p_excelOut2("milk",t) = p_res(%3,%4,"cows","milk",t) + eps;
  p_excelOut2("nLac",t) = p_res(%3,%4,"cows","nLac",t) + eps;

  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=cowsSummary!';
*
*  --- store crop hectares
*
  option kill=p_excelOut2;
  p_excelOut2(crops,t)  = p_res(%3,%4,crops,"ha",t) + eps;
  p_excelOut2("cropped",t) = sum(crops, p_res(%3,%4,crops,"ha",t)) + eps;
  p_excelOut2("rentOut",t) = p_res(%3,%4,"rentOut","ha",t) + eps;
  p_excelOut2("land",t)    = p_res(%3,%4,"sum","ha",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=lndUse!';
*
*  --- store major economic indicators
*
  option kill=p_excelOut2;
  p_excelOut2(econInd,t) = p_res(%3,%4,econInd,"sum",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=econInd!';
*
*  --- store animal product and crop revenues
*
  option kill=p_excelOut2;
  p_excelOut2(prods,t) = p_res(%3,%4,prods,"sReve",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=prodReve!';
*
*  --- store production quantities
*
  option kill=p_excelOut2;
  p_excelOut2(prods,t) = p_res(%3,%4,prods,"quant",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=prodQuant!';
*
*  --- Stables
*
  option kill=p_excelOut2;
  p_excelOut2(stables,t) = p_res(%3,%4,stables,"invent",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=stableInv!';
*
*  --- machinery
*
  option kill=p_excelOut2;
  p_excelOut2(machType,t) = p_res(%3,%4,machType,"invent",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=machInv!';
*
*  --- labour
*
  option kill=p_excelOut2;
  p_excelOut2(workType,t)     = p_res(%3,%4,workType,"hours",t) + eps;
  p_excelOut2(crops,t)        = p_res(%3,%4,crops,"hours",t) + eps;
  p_excelOut2(summaryHerds,t) = p_res(%3,%4,SummaryHerds,"hours",t) + eps;
  p_excelOut2("crops",t)      = p_res(%3,%4,"crops","hours",t) + eps;
  p_excelOut2("anim",t)       = p_res(%3,%4,"anim","hours",t) + eps;
  p_excelOut2("onfarm",t)     = p_res(%3,%4,"onFarm","hours",t) + eps;
  p_excelOut2("offfarm",t)    = p_res(%3,%4,"offFarm","hours",t) + eps;
  p_excelOut2("total",t)      = p_res(%3,%4,"total","hours",t) + eps;

  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=labour!';
*
*  --- liquidity and outstanding credits
*
  option kill=p_excelOut2;
  p_excelOut2("liquid",t)   = p_res(%3,%4,"liquid","sum",t) + eps;
  p_excelOut2("credits",t)  = p_res(%3,%4,"credits","sum",t) + eps;
  p_excelOut2(creditType,t) = p_res(%3,%4,creditType,"sum",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=liquid!';
*
*  --- capital use and credits
*
  option kill=p_excelOut2;
  p_excelOut2("sumInv",t)    = p_res(%3,%4,"sumInv","new",t) + eps;
  p_excelOut2("credits",t)   = p_res(%3,%4,"credits","new",t) + eps;
  p_excelOut2(creditType,t)  = p_res(%3,%4,creditType,"new",t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=financing!';
*
*  --- GHG Emissions
*
  option kill=p_excelOut2;
  p_excelOut2(ind,t)          = p_res(%3,%4,"GHGs",ind,t) + eps;
  put_utilities batch 'gdxout' / '%gdxFileName%';
  execute_unload p_excelOut2;
  put_utility 'shell' / 'gdxxrw.exe i=%gdxFileName% o=%excelFileName% epsout=0.0 par=p_excelOut2 rng=GHGs!';
