********************************************************************************
$ontext

   Dairdyn project

   GAMS file : GEN_res2GLOBIOM.GMS

   @purpose  : summary results for the connection to FARMIND
   @author   : D.Sch√§fer
   @date     : 04.07.2022
   @since    :
   @refDoc   :
   @seeAlso  :
   @calledBy :

$offtext
********************************************************************************



* --- Profits/Premiums

    p_sumResSwizz(%1,"profit","") = round (p_res("Base",%1,"objval","sum","","mean") ,2);
    p_sumResSwizz(%1,"totalPolicyPayments","")   =   round ( sum (t_n(tCur,nCur), v_countryPrem.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premFoodSupply","")        =   round ( sum (t_n(tCur,nCur), v_premFoodSupply.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premArab","")              =   round ( sum (t_n(tCur,nCur), v_premArab.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premGMF","")               =   round ( sum (t_n(tCur,nCur), v_premGMF.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premBFF","")               =   round ( sum (t_n(tCur,nCur), v_premBFF.l (tCur,nCur) ) /p_cardtCur   ,2  );
    p_sumResSwizz(%1,"premAnm","")               =   round ( sum (t_n(tCur,nCur), v_premAnimal.l (tCur,nCur) ) /p_cardtCur   ,2  );



* --- Current crops in ha

    p_sumResSwizz(%1,curCrops,"") = round (p_res("Base",%1,curCrops,"levl","","mean"),2);

* --- Animals in livestock units

    p_sumResSwizz(%1,"cowsLu","") = round(p_res("Base",%1,"cows","levl"," ","mean"),2)  ;
    p_sumResSwizz(%1,"motherCowsLu","") = round (p_res("Base",%1,"motherCow","levl"," ","mean"),2);
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"heifs")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean")     *0.6),2) ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"bulls")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean")     *0.4),2) ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"mCalvsRais")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean") * 0.3),2)  ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"mCalvsSold")    = round (p_res("Base",%1,possHerds,"levl"," ","mean"),2)  ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"fCalvsRais")    = round ((p_res("Base",%1,possHerds,"levl"," ","mean") * 0.3),2) ;
    p_sumResSwizz(%1,possherds,"") $ sameas (possherds,"fCalvsSold")    = round (p_res("Base",%1,possHerds,"levl"," ","mean"),2);

* --- Labour hours

    p_sumResSwizz(%1,"totalLabourHrs","")   =    p_res("Base",%1,"onFarm","hours","","mean");
    p_sumResSwizz(%1,"hiredLabourHrs","")  =   p_res("Base",%1,"hiredLabour","hours","","mean")  ;


*NH3,GWP,CO2,CH4,N2O,N2oind,N2
*GWP,CO2,CH4,N2O

    p_res(%1,%2,"inputgwp","Quant","",tCur)      =    sum((curChain,t_n(tCur,nCur)), p_probn(nCur) *   v_emissionsCat.l(curChain,"input","GWP",tCur,ncur) );
    p_res(%1,%2,"inputGWP","Quant","","mean")    =    sum( tCur, p_res(%1,%2,"inputgwp","Quant","",tCur) ) / p_cardtCur ;

    p_res(%1,%2,"emiCropsCO2","Quant","",tCur)   =    sum((curCrops(crops),curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiCrops(Crops,chain,source,"CO2",tCur,nCur));
    p_res(%1,%2,"emiCropsCO2","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiCropsCO2","Quant","",tCur) ) / p_cardtCur;

    p_res(%1,%2,"emiCropsN2o","Quant","",tCur)   =    sum((curCrops(crops),curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiCrops(Crops,chain,source,"N2o",tCur,nCur));
    p_res(%1,%2,"emiCropsN2o","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiCropsN2O","Quant","",tCur) ) / p_cardtCur;

    p_res(%1,%2,"emiCropsCH4","Quant","",tCur)   =    sum((curCrops(crops),curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiCrops(Crops,chain,source,"CH4",tCur,nCur));
    p_res(%1,%2,"emiCropsCH4","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiCropsCH4","Quant","",tCur) ) / p_cardtCur;

$iftheni.herd %herd% == true
    p_res(%1,%2,"emiherdsCO2","Quant","",tCur)   =    sum((possherds,curBreeds(breeds),curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiherds(possHerds,breeds,chain,source,"CO2",tCur,nCur));
    p_res(%1,%2,"emiherdsCO2","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiherdsCO2","Quant","",tCur) ) / p_cardtCur;

    p_res(%1,%2,"emiherdsN2o","Quant","",tCur)   =    sum((possherds,curBreeds(breeds),curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiherds(possHerds,breeds,chain,source,"N2O",tCur,nCur));
    p_res(%1,%2,"emiherdsN2o","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiherdsN2O","Quant","",tCur) ) / p_cardtCur;

    p_res(%1,%2,"emiherdsCH4","Quant","",tCur)   =    sum((possherds,curBreeds(breeds),curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiherds(possHerds,breeds,chain,source,"CH4",tCur,nCur));
    p_res(%1,%2,"emiherdsCH4","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiherdsCH4","Quant","",tCur) ) / p_cardtCur;
$endif.herd

    p_res(%1,%2,"emiotherCO2","Quant","",tCur)   =    sum((curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiother(chain,source,"CO2_eq",tCur,nCur));
    p_res(%1,%2,"emiOtherCO2","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiOtherCO2","Quant","",tCur) ) / p_cardtCur;

    p_res(%1,%2,"emiOtherN2o","Quant","",tCur)   =    sum((curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiother(chain,source,"N2o",tCur,nCur));
    p_res(%1,%2,"emiOtherN2o","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiOtherN2O","Quant","",tCur) ) / p_cardtCur;

    p_res(%1,%2,"emiOtherCH4","Quant","",tCur)   =    sum((curChain(chain),source,t_n(tCur,nCur)), p_probN(nCur)
                                                                                        * v_emiother(chain,source,"CH4",tCur,nCur));
    p_res(%1,%2,"emiOtherCH4","Quant","","mean")   =    sum (tCur,p_res(%1,%2,"emiOtherCH4","Quant","",tCur) ) / p_cardtCur;


* ---- Important GWP Units
    p_sumResSwizz(%1,"totalGWP","")    = p_res("Base",%1,"totGWP","Quant","","mean");
    p_sumResSwizz(%1,"entFermGWP","")    = p_res("Base",%1,"entFermGWP","Quant","","mean");
    p_sumResSwizz(%1,"inputGWP","")    = p_res("Base",%1,"inputGWP","Quant","","mean");
* --- emission separated by CO2,CH4,N2o and GWP for emiCrops and emiHerds

   p_sumResSwizz(%1,"emisCrops","CO2")  = p_res("Base",%1,"emiCropsCO2","Quant","","mean");
   p_sumResSwizz(%1,"emisCrops","CH4")  = p_res("Base",%1,"emiCropsCH4","Quant","","mean");
   p_sumResSwizz(%1,"emisCrops","N2O")  = p_res("Base",%1,"emiCropsN2O","Quant","","mean");

   p_sumResSwizz(%1,"emisHerds","CO2")  = p_res("Base",%1,"emiherdsCO2","Quant","","mean");
   p_sumResSwizz(%1,"emisHerds","CH4")  = p_res("Base",%1,"emiherdsCH4","Quant","","mean");
   p_sumResSwizz(%1,"emisHerds","N2O")  = p_res("Base",%1,"emiherdsN2O","Quant","","mean");

   p_sumResSwizz(%1,"emisOther","CO2")  = p_res("Base",%1,"emiotherCO2","Quant","","mean");
   p_sumResSwizz(%1,"emisOther","CH4")  = p_res("Base",%1,"emiOtherCH4","Quant","","mean");
   p_sumResSwizz(%1,"emisOther","N2O")  = p_res("Base",%1,"emiOtherN2O","Quant","","mean");

